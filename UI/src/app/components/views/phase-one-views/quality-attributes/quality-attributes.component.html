
<div>
  <button mat-button matStepperPrevious>Back</button>
  <button mat-button matStepperNext>Next</button>
  <button mat-button (click)="fireAll()">Fire all</button>
</div>
<div fxLayout="row" fxLayoutGap="30px">
  <mat-card class="scenario-card" class="mat-elevation-z8">
    <mat-card-title
      >Scenarios
      <button
        style="margin-left: 10px; margin-bottom: 10px"
        mat-mini-fab
        class="attribute-button"
        color="primary"
        (click)="addEmptyScenario()"
      >
        <mat-icon>add</mat-icon>
      </button></mat-card-title
    >

    <div class="outside" cdkScrollable>
    <div  class="mat-elevation-z8"
      cdkDropList
      class="drop-list"
      (cdkDropListDropped)="drop($event)"
      [cdkDropListData]="scenarioList"
    >
      <div fxLayout="row" fxLayoutGap="5px"
        *ngFor="let scenario of scenarioList"
        [cdkDragData]="scenario"
        cdkDragLockAxis="y"
        cdkDragBoundary=".drop-list"
        cdkDrag
        (click)="scenarioSelected(scenario)"
        [ngClass]="{
          'selected-drop-box': checkCurrentScenario(scenario),
          'drop-box': !checkCurrentScenario(scenario)
        }"
      >
      <div class="drop-handle" cdkDragHandle>
          <mat-icon mat-list-icon>drag_indicator</mat-icon>
        </div>
        <mat-form-field appearance="fill">
          <mat-label>Name</mat-label>
          <input matInput [(ngModel)]="scenario.name" />
        </mat-form-field>
        <mat-form-field class="description-field" appearance="fill">
          <mat-label>Description</mat-label>
          <input matInput [(ngModel)]="scenario.description" />
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Importance</mat-label>
          <mat-select [(value)]="scenario.importance">
            <mat-option *ngFor="let rating of enumKeys" [value]="rating">{{
              rating
            }}</mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Difficulty</mat-label>
          <mat-select [(value)]="scenario.difficulty">
            <mat-option *ngFor="let rating of enumKeys" [value]="rating">{{
              rating
            }}</mat-option>
          </mat-select>
        </mat-form-field>
        <button mat-button (click)="deleteScenario(scenario)"><mat-icon mat-list-icon>close</mat-icon></button>
      </div>
    </div>
    </div>
  </mat-card>
  <mat-card *ngIf="selectedScenario !== undefined" class="mat-elevation-z8">
    <mat-card-title>Quality Attributes</mat-card-title>
    <mat-accordion >
      <ng-container *ngFor="let qa of qualityList">
        <ng-container
          *ngIf="qa.qualitySubLevels.length > 0; else singleAttribute"
        >
          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title>
                <section>
                  <mat-checkbox
                    class="example-margin"
                    (click)="$event.stopPropagation()"
                    (keydown)="$event.stopPropagation()"
                    (change)="addOrRemoveQuality($event.checked, qa); checkOrUncheckAll($event.checked, qa)"
                    [checked]="checkIfQualityExist(qa.name)"
                    [indeterminate]="someChecked(qa.name) && !allChecked(qa)"
                  >
                    {{ qa.name }}</mat-checkbox
                  >
                </section></mat-panel-title
              >
              <mat-panel-description> </mat-panel-description>
            </mat-expansion-panel-header>

            <section *ngFor="let sqa of qa.qualitySubLevels">
              <mat-checkbox
                class="example-margin"
                (click)="$event.stopPropagation()"
                (keydown)="$event.stopPropagation()"
                (change)="addOrRemoveQualitySub($event.checked, sqa)"
                [checked]="checkIfQualitySubExist(sqa.name)"
              >
                {{ sqa.name }}</mat-checkbox
              >
            </section>
          </mat-expansion-panel>
        </ng-container>

        <ng-template #singleAttribute>
          <mat-expansion-panel hideToggle>
            <mat-expansion-panel-header
              #panelHeader
              (click)="panelHeader._toggle()"
            >
              <mat-panel-title>
                <section>
                  <mat-checkbox
                    class="example-margin"
                    (click)="$event.stopPropagation()"
                    (keydown)="$event.stopPropagation()"
                    (change)="addOrRemoveQuality($event.checked, qa)"
                    [checked]="checkIfQualityExist(qa.name)"
                  >
                    {{ qa.name }}</mat-checkbox
                  >
                </section></mat-panel-title
              >
              <mat-panel-description> </mat-panel-description>
            </mat-expansion-panel-header>
          </mat-expansion-panel>
        </ng-template>
      </ng-container>
    </mat-accordion>
  </mat-card>
</div>
